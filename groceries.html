<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Groceries - Domus</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <style>
        /* ‚îÄ‚îÄ Modal footer buttons ‚îÄ‚îÄ */
        .modal-footer {
            padding: 14px 24px 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            border-top: 1px solid var(--gray-100);
        }
        .modal-cancel-btn {
            padding: 10px 18px;
            border: 1.5px solid var(--gray-200);
            border-radius: var(--radius-sm);
            background: transparent;
            color: var(--gray-700);
            font-weight: 500;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            transition: background 0.15s;
        }
        .modal-cancel-btn:hover { background: var(--gray-100); }
        .modal-action-btn {
            padding: 10px 22px;
            background: linear-gradient(135deg, var(--navy), var(--navy-mid));
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 600;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            transition: opacity 0.15s;
        }
        .modal-action-btn:hover { opacity: 0.88; }

        /* ‚îÄ‚îÄ Store cards (Find Stores modal) ‚îÄ‚îÄ */
        .store-card {
            border-bottom: 1px solid var(--gray-100);
            padding: 18px 24px;
        }
        .store-card:last-child { border-bottom: none; }
        .store-card-top {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 10px;
        }
        .store-name { font-size: 15px; font-weight: 700; color: var(--text-dark); }
        .store-meta { font-size: 12px; color: var(--gray-500); margin-top: 3px; }
        .store-hours { font-size: 12px; margin-top: 3px; font-weight: 500; }
        .store-open  { color: #059669; }
        .store-closed{ color: #DC2626; }
        .store-badge {
            background: linear-gradient(135deg, var(--orange), var(--orange-light));
            color: white;
            font-size: 10px;
            font-weight: 700;
            padding: 3px 10px;
            border-radius: 20px;
            white-space: nowrap;
            flex-shrink: 0;
            text-transform: uppercase;
            letter-spacing: 0.4px;
        }
        .store-deals-label {
            font-size: 11px;
            font-weight: 700;
            color: var(--gray-500);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
        .store-deal-row {
            font-size: 13px;
            color: var(--text-dark);
            padding: 2px 0;
            line-height: 1.5;
        }
        .store-dir-btn {
            width: 100%;
            padding: 9px;
            background: transparent;
            border: 1.5px solid var(--gray-200);
            border-radius: var(--radius-sm);
            font-size: 13px;
            font-weight: 600;
            color: var(--navy);
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: all 0.15s;
            margin-top: 12px;
        }
        .store-dir-btn:hover { background: var(--navy); color: white; border-color: var(--navy); }

        /* ‚îÄ‚îÄ Reorder item rows ‚îÄ‚îÄ */
        .reorder-row {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 9px 0;
            border-bottom: 1px solid var(--gray-100);
            font-size: 14px;
            color: var(--text-dark);
        }
        .reorder-row:last-child { border-bottom: none; }
        .reorder-row input[type="checkbox"] { width:16px; height:16px; accent-color: var(--orange); cursor:pointer; flex-shrink:0; }
        .reorder-label { flex: 1; font-weight: 500; }
        .reorder-qty   { font-size: 11px; color: var(--gray-500); background: var(--gray-100); padding: 2px 8px; border-radius: 12px; }
        .reorder-price { font-size: 13px; font-weight: 600; color: var(--gray-700); min-width: 44px; text-align: right; }

        /* ‚îÄ‚îÄ Success screens inside modals ‚îÄ‚îÄ */
        .modal-success-screen {
            text-align: center;
            padding: 28px 24px 24px;
        }
        .modal-success-icon { font-size: 46px; margin-bottom: 12px; }
        .modal-success-title { font-size: 17px; font-weight: 700; color: var(--text-dark); margin-bottom: 6px; }
        .modal-success-sub   { font-size: 13px; color: var(--gray-500); }

        /* ‚îÄ‚îÄ Dark mode overrides for new elements ‚îÄ‚îÄ */
        [data-theme="dark"] .modal-cancel-btn { border-color: #2D3748; color: #C9D1D9; }
        [data-theme="dark"] .modal-cancel-btn:hover { background: #21262D; }
        [data-theme="dark"] .store-card { border-bottom-color: #21262D; }
        [data-theme="dark"] .reorder-row { border-bottom-color: #21262D; }
        [data-theme="dark"] .modal-footer { border-top-color: #21262D; }
        [data-theme="dark"] .store-dir-btn { border-color: #2D3748; color: #C9D1D9; }
        [data-theme="dark"] .store-dir-btn:hover { background: var(--navy-mid); color: white; border-color: var(--navy-mid); }
        [data-theme="dark"] .reorder-qty { background: #21262D; }
    </style>
</head>
<body>
    <header class="header">
        <div class="main-header">
            <h2 class="topheader"><a class="logo" href="index.html">Domus</a></h2>
        </div>
        <nav class="centertabs">
            <ul class="other_tabs1">
                <li class="tab" id="banks" onclick="loadPage('banks')">Banks</li>
                <li class="tab active" id="groceries" onclick="loadPage('groceries')">Groceries</li>
                <li class="tab" id="school" onclick="loadPage('school')">School</li>
                <li class="tab" id="spending-analyzer" onclick="loadPage('spending-analyzer')">Spending Analyzer</li>
                <li class="tab" id="utilities" onclick="loadPage('utilities')">Utilities</li>
                <li class="tab" id="work" onclick="loadPage('work')">Work</li>
                
            </ul>
        </nav>
        <button id="theme-btn" class="theme-toggle-btn" onclick="ThemeToggle.toggle()" title="Switch to dark mode">&#127769;</button>
    <button class="header-chat-btn" onclick="ChatWidget.toggle()">&#x1F4AC; <span>Ask Domus</span></button>
    </header>
    <main>
        <section class="page-hero">
            <div>
                <div class="sub-hero-badge">&#128722; Grocery Manager</div>
                <h1 class="sub-hero-title">Smart Grocery Planner</h1>
                <p class="sub-hero-tagline">Track, budget, and shop smarter every week</p>
                <p class="sub-hero-desc">Manage your grocery budget, build smart shopping lists, compare prices across stores, and track spending by category ‚Äî all in one place.</p>
            </div>
          
        </section>

        <div class="stats-bar">
            <div class="stat-card green"><span class="stat-icon">&#128722;</span><div class="stat-label">Monthly Budget</div><div class="stat-value">$600</div><div class="stat-sub">Set for March 2026</div></div>
            <div class="stat-card orange"><span class="stat-icon">&#128179;</span><div class="stat-label">Spent So Far</div><div class="stat-value">$387</div><div class="stat-sub">64% of budget used</div></div>
            <div class="stat-card teal"><span class="stat-icon">&#129001;</span><div class="stat-label">Remaining</div><div class="stat-value">$213</div><div class="stat-sub">3 days left in month</div></div>
            <div class="stat-card navy"><span class="stat-icon">&#128203;</span><div class="stat-label">Items on List</div><div class="stat-value">18</div><div class="stat-sub">4 already picked up</div></div>
        </div>

        <div class="two-col">
            <div class="content-card">
                <div class="content-card-title">&#128203; Shopping List <span style="margin-left:auto;font-size:12px;font-weight:500;color:var(--orange);cursor:pointer" onclick="GroceryApp.openAddItem()">+ Add Item</span></div>
                <div class="check-item check-done"><input type="checkbox" id="g1" checked onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g1">Organic Whole Milk <span class="check-qty">1 gal</span></label><span class="check-price">$5.99</span></div>
                <div class="check-item check-done"><input type="checkbox" id="g2" checked onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g2">Large Eggs <span class="check-qty">1 doz</span></label><span class="check-price">$4.29</span></div>
                <div class="check-item check-done"><input type="checkbox" id="g3" checked onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g3">Greek Yogurt <span class="check-qty">3 pack</span></label><span class="check-price">$6.49</span></div>
                <div class="check-item check-done"><input type="checkbox" id="g4" checked onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g4">Whole Wheat Bread <span class="check-qty">1 loaf</span></label><span class="check-price">$3.79</span></div>
                <div class="check-item"><input type="checkbox" id="g5" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g5">Chicken Breast <span class="check-qty">2 lbs</span></label><span class="check-price">$9.99</span></div>
                <div class="check-item"><input type="checkbox" id="g6" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g6">Atlantic Salmon <span class="check-qty">1 lb</span></label><span class="check-price">$12.99</span></div>
                <div class="check-item"><input type="checkbox" id="g7" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g7">Baby Spinach <span class="check-qty">5 oz bag</span></label><span class="check-price">$3.49</span></div>
                <div class="check-item"><input type="checkbox" id="g8" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g8">Avocados <span class="check-qty">3 ct</span></label><span class="check-price">$4.99</span></div>
                <div class="check-item"><input type="checkbox" id="g9" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g9">Gala Apples <span class="check-qty">3 lb bag</span></label><span class="check-price">$5.49</span></div>
                <div class="check-item"><input type="checkbox" id="g10" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g10">Extra Virgin Olive Oil <span class="check-qty">16 oz</span></label><span class="check-price">$8.99</span></div>
                <div class="check-item"><input type="checkbox" id="g11" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g11">Brown Rice <span class="check-qty">2 lb bag</span></label><span class="check-price">$3.29</span></div>
                <div class="check-item"><input type="checkbox" id="g12" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g12">Penne Pasta <span class="check-qty">3 boxes</span></label><span class="check-price">$3.99</span></div>
                <div class="check-item"><input type="checkbox" id="g13" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g13">Sharp Cheddar <span class="check-qty">8 oz block</span></label><span class="check-price">$4.99</span></div>
                <div class="check-item"><input type="checkbox" id="g14" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g14">Orange Juice <span class="check-qty">64 oz</span></label><span class="check-price">$5.79</span></div>
                <div class="check-item"><input type="checkbox" id="g15" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g15">Broccoli <span class="check-qty">1 head</span></label><span class="check-price">$1.99</span></div>
                <div class="check-item"><input type="checkbox" id="g16" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g16">Fresh Blueberries <span class="check-qty">1 pint</span></label><span class="check-price">$4.49</span></div>
                <div class="check-item"><input type="checkbox" id="g17" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g17">Roma Tomatoes <span class="check-qty">4 ct</span></label><span class="check-price">$2.49</span></div>
                <div class="check-item"><input type="checkbox" id="g18" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)"><label class="check-label" for="g18">Raw Almonds <span class="check-qty">16 oz bag</span></label><span class="check-price">$9.99</span></div>
            </div>
            <div>
                <div class="content-card">
                    <div class="content-card-title">&#128202; Budget by Category</div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#129382; Produce</span><span class="cat-amounts">$82 / $150</span></div><div class="progress-wrap"><div class="progress-bar green" style="width:55%"></div></div></div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#129385; Meat &amp; Fish</span><span class="cat-amounts">$98 / $120</span></div><div class="progress-wrap"><div class="progress-bar" style="width:82%"></div></div></div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#129371; Dairy &amp; Eggs</span><span class="cat-amounts">$72 / $80</span></div><div class="progress-wrap"><div class="progress-bar red" style="width:90%"></div></div></div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#127807; Pantry Staples</span><span class="cat-amounts">$65 / $90</span></div><div class="progress-wrap"><div class="progress-bar" style="width:72%"></div></div></div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#129381; Beverages</span><span class="cat-amounts">$38 / $60</span></div><div class="progress-wrap"><div class="progress-bar green" style="width:63%"></div></div></div>
                    <div class="cat-row"><div class="cat-header"><span class="cat-name">&#127839; Snacks</span><span class="cat-amounts">$32 / $50</span></div><div class="progress-wrap"><div class="progress-bar green" style="width:64%"></div></div></div>
                </div>
                <div class="content-card">
                    <div class="content-card-title">&#127978; Store Price Comparison</div>
                    <div class="list-item"><div class="list-icon orange">&#128722;</div><div class="list-info"><div class="list-name">Walmart Supercenter</div><div class="list-sub">Lowest everyday prices</div></div><div><div class="list-amount">$81.37</div><div style="text-align:right;margin-top:4px"><span class="badge badge-green">Cheapest</span></div></div></div>
                    <div class="list-item"><div class="list-icon green">&#128722;</div><div class="list-info"><div class="list-name">Trader Joe's</div><div class="list-sub">Best quality-to-price ratio</div></div><div class="list-amount">$94.20</div></div>
                    <div class="list-item"><div class="list-icon blue">&#128722;</div><div class="list-info"><div class="list-name">Target</div><div class="list-sub">RedCard saves 5%</div></div><div class="list-amount">$99.80</div></div>
                    <div class="list-item"><div class="list-icon gray">&#128722;</div><div class="list-info"><div class="list-name">Whole Foods Market</div><div class="list-sub">Prime member discounts</div></div><div class="list-amount">$112.45</div></div>
                </div>
            </div>
        </div>
        <div class="quick-actions">
            <button class="action-btn" onclick="GroceryApp.openAddItem()">&#10133; Add Item</button>
            <button class="action-btn" onclick="GroceryApp.shareList()">&#128228; Share List</button>
            <button class="action-btn" onclick="GroceryApp.openReorder()">&#128260; Reorder Last Trip</button>
            <button class="action-btn" onclick="window.location='spending-analyzer.html'">&#128202; Monthly Report</button>
            <button class="action-btn" onclick="GroceryApp.openStores()">&#128205; Find Stores Nearby</button>
        </div>
    </main>
    <footer>
        <p>&copy; 2026 <strong>Domus</strong> &mdash; Fiserv Future Techies Challenge</p>
    </footer>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         ADD ITEM MODAL
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="add-item-modal" class="modal-overlay" onclick="if(event.target===this)GroceryApp.closeAddItem()">
        <div class="modal-card">
            <div class="modal-header">
                <div class="modal-header-title">
                    <div class="modal-header-icon">‚ûï</div>
                    <div>
                        <div class="modal-title">Add to Shopping List</div>
                        <div class="modal-subtitle">New item appears at the bottom of your list</div>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="GroceryApp.closeAddItem()">‚úï</button>
            </div>
            <div class="modal-body" id="ai-form-body">
                <div class="modal-field">
                    <label class="modal-label">Item Name *</label>
                    <input id="ai-name" class="modal-input" type="text" placeholder="e.g. Chicken Breast"
                        onkeydown="if(event.key==='Enter')GroceryApp.submitAddItem()">
                </div>
                <div class="modal-field-row">
                    <div class="modal-field">
                        <label class="modal-label">Quantity</label>
                        <input id="ai-qty" class="modal-input" type="text" placeholder="e.g. 2 lbs">
                    </div>
                    <div class="modal-field">
                        <label class="modal-label">Est. Price</label>
                        <input id="ai-price" class="modal-input" type="number" placeholder="0.00" step="0.01" min="0">
                    </div>
                </div>
            </div>
            <div class="modal-success-screen" id="ai-success" style="display:none">
                <div class="modal-success-icon">‚úÖ</div>
                <div class="modal-success-title" id="ai-added-name"></div>
                <div class="modal-success-sub">Added to your shopping list!</div>
            </div>
            <div class="modal-footer" id="ai-footer">
                <button class="modal-cancel-btn" onclick="GroceryApp.closeAddItem()">Cancel</button>
                <button class="modal-action-btn" onclick="GroceryApp.submitAddItem()">‚ûï Add to List</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         REORDER LAST TRIP MODAL
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="reorder-modal" class="modal-overlay" onclick="if(event.target===this)GroceryApp.closeReorder()">
        <div class="modal-card">
            <div class="modal-header">
                <div class="modal-header-title">
                    <div class="modal-header-icon">üîÑ</div>
                    <div>
                        <div class="modal-title">Reorder Last Trip</div>
                        <div class="modal-subtitle">Feb 26 &nbsp;¬∑&nbsp; Trader Joe's &nbsp;¬∑&nbsp; $94.20 total</div>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="GroceryApp.closeReorder()">‚úï</button>
            </div>
            <div class="modal-body" id="reorder-body" style="max-height:360px;overflow-y:auto">
                <p style="font-size:13px;color:var(--gray-500);margin-bottom:14px">
                    Select items to add back to your current shopping list:
                </p>
                <div id="reorder-items"></div>
            </div>
            <div class="modal-success-screen" id="reorder-success" style="display:none">
                <div class="modal-success-icon">üõí</div>
                <div class="modal-success-title" id="reorder-msg"></div>
                <div class="modal-success-sub">Added to your shopping list</div>
            </div>
            <div class="modal-footer" id="reorder-footer">
                <button class="modal-cancel-btn" onclick="GroceryApp.closeReorder()">Cancel</button>
                <button class="modal-action-btn" onclick="GroceryApp.submitReorder()">üõí Add Selected Items</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         FIND STORES NEARBY MODAL
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="stores-modal" class="modal-overlay" onclick="if(event.target===this)GroceryApp.closeStores()">
        <div class="modal-card" style="max-width:500px">
            <div class="modal-header">
                <div class="modal-header-title">
                    <div class="modal-header-icon">üìç</div>
                    <div>
                        <div class="modal-title">Stores Near You</div>
                        <div class="modal-subtitle">5 grocery stores found &nbsp;¬∑&nbsp; Updated today</div>
                    </div>
                </div>
                <button class="modal-close-btn" onclick="GroceryApp.closeStores()">‚úï</button>
            </div>
            <div style="max-height:480px;overflow-y:auto" id="stores-list"></div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
         GROCERY APP LOGIC
    ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script>
    const GroceryApp = {
        _nextId: 19,

        _esc(s) {
            return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        },

        // ‚îÄ‚îÄ‚îÄ ADD ITEM ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        openAddItem() {
            document.getElementById('ai-name').value  = '';
            document.getElementById('ai-qty').value   = '';
            document.getElementById('ai-price').value = '';
            document.getElementById('ai-name').style.borderColor = '';
            document.getElementById('ai-success').style.display  = 'none';
            document.getElementById('ai-form-body').style.display = '';
            document.getElementById('ai-footer').style.display    = 'flex';
            document.getElementById('add-item-modal').classList.add('open');
            setTimeout(() => document.getElementById('ai-name').focus(), 120);
        },

        closeAddItem() {
            document.getElementById('add-item-modal').classList.remove('open');
        },

        submitAddItem() {
            const nameEl = document.getElementById('ai-name');
            const name   = nameEl.value.trim();
            if (!name) {
                nameEl.style.borderColor = 'var(--orange)';
                nameEl.focus();
                return;
            }
            const qty   = document.getElementById('ai-qty').value.trim()   || '1';
            const price = parseFloat(document.getElementById('ai-price').value) || 0;
            const priceTxt = price > 0 ? `$${price.toFixed(2)}` : '‚Äî';
            const id = `g${this._nextId++}`;

            // Build new list row
            const el = document.createElement('div');
            el.className = 'check-item';
            el.innerHTML = `
                <input type="checkbox" id="${id}" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)">
                <label class="check-label" for="${id}">${this._esc(name)} <span class="check-qty">${this._esc(qty)}</span></label>
                <span class="check-price">${priceTxt}</span>`;

            // Append after last check-item in the first content-card
            const items = document.querySelectorAll('.content-card .check-item');
            if (items.length) items[items.length - 1].after(el);

            // Update "Items on List" counter
            const counter = document.querySelector('.stat-card.navy .stat-value');
            if (counter) counter.textContent = parseInt(counter.textContent || '0') + 1;

            // Show success screen
            document.getElementById('ai-added-name').textContent = name;
            document.getElementById('ai-form-body').style.display = 'none';
            document.getElementById('ai-footer').style.display    = 'none';
            document.getElementById('ai-success').style.display   = 'block';

            showToast(`‚úÖ "${name}" added to your shopping list!`, 'success');
            setTimeout(() => this.closeAddItem(), 1800);
        },

        // ‚îÄ‚îÄ‚îÄ SHARE LIST ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        shareList() {
            const date = new Date().toLocaleDateString('en-US', { month:'long', day:'numeric', year:'numeric' });
            const lines = [`üìã Domus Shopping List ‚Äî ${date}`, ''];
            let picked = 0, total = 0;

            document.querySelectorAll('.content-card .check-item').forEach(item => {
                const done  = item.classList.contains('check-done');
                const label = item.querySelector('.check-label');
                const qty   = item.querySelector('.check-qty');
                const price = item.querySelector('.check-price');
                const name  = label ? label.childNodes[0].textContent.trim() : '?';
                const q     = qty   ? qty.textContent.trim()   : '';
                const p     = price ? price.textContent.trim() : '';
                lines.push(`${done ? '‚úì' : '‚óã'} ${name}${q ? ` (${q})` : ''} ‚Äî ${p}`);
                if (done) picked++;
                total++;
            });

            lines.push('', `${picked} of ${total} items picked up`);
            lines.push('Shared via Domus üè†');

            if (!navigator.clipboard) {
                showToast('Clipboard not available in this browser', 'error');
                return;
            }
            navigator.clipboard.writeText(lines.join('\n'))
                .then(() => showToast(`üìã Shopping list copied! ${total} items ready to paste anywhere.`, 'success'))
                .catch(() => showToast('Could not copy ‚Äî try manually selecting the list', 'error'));
        },

        // ‚îÄ‚îÄ‚îÄ REORDER LAST TRIP ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        _lastTrip: [
            { name: 'Organic Whole Milk',   qty: '1 gal',    price: '$5.99' },
            { name: 'Large Eggs',           qty: '1 doz',    price: '$4.29' },
            { name: 'Greek Yogurt',         qty: '3 pack',   price: '$6.49' },
            { name: 'Whole Wheat Bread',    qty: '1 loaf',   price: '$3.79' },
            { name: 'Baby Spinach',         qty: '5 oz bag', price: '$3.49' },
            { name: 'Gala Apples',          qty: '3 lb bag', price: '$5.49' },
            { name: 'Orange Juice',         qty: '64 oz',    price: '$5.79' },
            { name: 'Brown Rice',           qty: '2 lb bag', price: '$3.29' },
            { name: 'Penne Pasta',          qty: '3 boxes',  price: '$3.99' },
            { name: 'Fresh Blueberries',    qty: '1 pint',   price: '$4.49' },
            { name: 'Roma Tomatoes',        qty: '4 ct',     price: '$2.49' },
            { name: 'Sharp Cheddar',        qty: '8 oz',     price: '$4.99' },
        ],

        openReorder() {
            const c = document.getElementById('reorder-items');
            c.innerHTML = this._lastTrip.map((item, i) => `
                <div class="reorder-row">
                    <input type="checkbox" id="rt${i}" checked>
                    <label class="reorder-label" for="rt${i}">${this._esc(item.name)}</label>
                    <span class="reorder-qty">${this._esc(item.qty)}</span>
                    <span class="reorder-price">${this._esc(item.price)}</span>
                </div>`).join('');

            document.getElementById('reorder-success').style.display = 'none';
            document.getElementById('reorder-body').style.display    = '';
            document.getElementById('reorder-footer').style.display  = 'flex';
            document.getElementById('reorder-modal').classList.add('open');
        },

        closeReorder() {
            document.getElementById('reorder-modal').classList.remove('open');
        },

        submitReorder() {
            const checked = [...document.querySelectorAll('#reorder-items input:checked')];
            if (!checked.length) {
                showToast('Select at least one item to add', 'info');
                return;
            }

            const items = document.querySelectorAll('.content-card .check-item');
            const lastItem = items[items.length - 1];

            checked.forEach(cb => {
                const idx  = parseInt(cb.id.replace('rt', ''));
                const trip = this._lastTrip[idx];
                const id   = `g${this._nextId++}`;
                const el   = document.createElement('div');
                el.className = 'check-item';
                el.innerHTML = `
                    <input type="checkbox" id="${id}" onchange="this.closest('.check-item').classList.toggle('check-done',this.checked)">
                    <label class="check-label" for="${id}">${this._esc(trip.name)} <span class="check-qty">${this._esc(trip.qty)}</span></label>
                    <span class="check-price">${this._esc(trip.price)}</span>`;
                if (lastItem) lastItem.after(el);
            });

            const counter = document.querySelector('.stat-card.navy .stat-value');
            if (counter) counter.textContent = parseInt(counter.textContent || '0') + checked.length;

            const n = checked.length;
            document.getElementById('reorder-msg').textContent = `${n} item${n !== 1 ? 's' : ''} added to your list`;
            document.getElementById('reorder-body').style.display   = 'none';
            document.getElementById('reorder-footer').style.display = 'none';
            document.getElementById('reorder-success').style.display = 'block';

            showToast(`üõí ${n} item${n !== 1 ? 's' : ''} from last trip added to your list!`, 'success');
            setTimeout(() => this.closeReorder(), 2200);
        },

        // ‚îÄ‚îÄ‚îÄ FIND STORES NEARBY ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        _stores: [
            {
                name: 'Walmart Supercenter', dist: '0.8 mi', addr: '1234 Market Blvd',
                hours: 'Open until 11:00 PM', open: true, badge: 'üí∞ Cheapest for your list',
                deals: [
                    { e: 'üçó', t: 'Chicken Breast ‚Äî $3.97/lb (Save $2.00)' },
                    { e: 'ü•õ', t: 'Great Value Whole Milk ‚Äî $3.48/gal' },
                    { e: 'üçû', t: 'Nature\'s Own Bread ‚Äî $2.98 (was $4.29)' },
                ]
            },
            {
                name: 'Trader Joe\'s', dist: '1.2 mi', addr: '567 Oak Street',
                hours: 'Open until 9:00 PM', open: true, badge: '‚≠ê Best quality-to-price',
                deals: [
                    { e: 'ü•ë', t: 'Organic Avocados ‚Äî 4 for $3.99' },
                    { e: 'ü´ê', t: 'Organic Blueberries ‚Äî $3.49/pint' },
                    { e: 'üßÄ', t: 'Unexpected Cheddar ‚Äî $4.99/8 oz block' },
                ]
            },
            {
                name: 'Target', dist: '1.6 mi', addr: '890 Pine Avenue',
                hours: 'Open until 10:00 PM', open: true, badge: null,
                deals: [
                    { e: 'üéØ', t: 'RedCard holders save 5% on everything' },
                    { e: 'ü•ö', t: 'Good & Gather Eggs ‚Äî $3.79/doz (RedCard price)' },
                    { e: 'ü´í', t: 'EVOO 16 oz ‚Äî $6.99 (was $9.99)' },
                ]
            },
            {
                name: 'Whole Foods Market', dist: '2.1 mi', addr: '321 Elm Drive',
                hours: 'Open until 9:00 PM', open: true, badge: null,
                deals: [
                    { e: 'üêü', t: 'Wild Atlantic Salmon ‚Äî $11.99/lb (Prime)' },
                    { e: 'üåø', t: '365 Baby Spinach 5 oz ‚Äî $2.99 (Prime)' },
                    { e: 'üßÉ', t: 'Organic OJ 64 oz ‚Äî $4.99 (Prime price)' },
                ]
            },
            {
                name: 'Kroger', dist: '2.4 mi', addr: '654 Maple Lane',
                hours: 'Open until 10:00 PM', open: true, badge: null,
                deals: [
                    { e: 'üçó', t: 'Kroger Chicken Breast ‚Äî $2.99/lb (Kroger Card)' },
                    { e: 'ü•£', t: 'Greek Yogurt Variety 3-pk ‚Äî $5.49' },
                    { e: 'üçö', t: 'Kroger Brown Rice 2 lb ‚Äî $2.49' },
                ]
            },
        ],

        openStores() {
            document.getElementById('stores-list').innerHTML = this._stores.map(s => `
                <div class="store-card">
                    <div class="store-card-top">
                        <div>
                            <div class="store-name">${this._esc(s.name)}</div>
                            <div class="store-meta">üìç ${this._esc(s.dist)} &nbsp;¬∑&nbsp; ${this._esc(s.addr)}</div>
                            <div class="store-hours ${s.open ? 'store-open' : 'store-closed'}">
                                üïê ${this._esc(s.hours)}
                            </div>
                        </div>
                        ${s.badge ? `<span class="store-badge">${this._esc(s.badge)}</span>` : ''}
                    </div>
                    <div class="store-deals-label">üîñ Today's deals</div>
                    ${s.deals.map(d => `<div class="store-deal-row">${d.e} ${this._esc(d.t)}</div>`).join('')}
                    <button class="store-dir-btn" onclick="GroceryApp._directions('${this._esc(s.name)}')">
                        üìç Get Directions to ${this._esc(s.name)}
                    </button>
                </div>`).join('');
            document.getElementById('stores-modal').classList.add('open');
        },

        closeStores() {
            document.getElementById('stores-modal').classList.remove('open');
        },

        _directions(name) {
            showToast(`üìç Opening directions to ${name}‚Ä¶`, 'info');
        }
    };
    </script>
</body>
</html>
